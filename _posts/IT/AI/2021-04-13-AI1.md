---
title: "Feature engineering : 정형 데이터"
author: Daekyo Jeong
date: 2021-04-13 23:00:00 +0900
categories: [IT, AI]
tags: [IT, AI, Machine Learning, Deep Learning]

math: true
---

---
**Contents**

{:.no_toc}

* Will be replaced with the ToC, excluding the "Contents" header
{:toc}
---

<br/>

# **Feature Engineering**  

Feature Engineering 이란 최초의 raw data를 어떠한 처리 과정을 거쳐 모델에 입력으로 사용하는 일이다.  

'Garbage in, Garbage out' 이라는 말처럼, 데이터를 얼마나 잘 처리해줄 수 있는지는 결과에 큰 영향을 미친다.  

# **정형 데이터**  

일반적으로, 정형 데이터란 데이터베이스에서 정해진 규칙에 맞게 들어간 데이터 중 수치만으로 의미 파악이 용이한 데이터들을 말한다.  

수치형, 카테고리형 데이터들이 여기에 해당된다.  

# **정규화(Normalization)**  

### **수치형 데이터**  

수치형 데이터는 정규화가 가장 쉽고, 명확하다.  

목적은 값의 범위들이 다른 Feature들을 비슷한 수치 구간으로 이동시키기 위해 진행한다.  

Feature들의 수치 범위가 제각각이라면 학습을 진행하는 과정에서 수치 범위가 더 넓은 Feature에 영향을 더 많이 받게 될 것이다.  

일반적으로 학습 과정에서 경사하강법을 사용하는 경우에는 정규화를 진행해야 한다.  

하지만 그렇지 않은 경우에는 반드시 정규화를 진행해야 하는 것은 아니라고 한다.  

가장 자주 사용되는 정규화 기법은 다음과 같다.  

##### **Min-Max Scaling**  

이름처럼 최대값과 최소값을 이용하여 [0,1] 범위로 투영시킨다.  


$$
X_{norm} = \frac{X - X_{min}}{X_{max} - X_{min}}
$$   

##### **Z-score Normalization**  

데이터를 평균이 0이고 표준편차가 1인 분포상으로 투영한다.  

데이터의 평균이 $$\mu$$, 표준편차가 $$\sigma$$ 라고 할 때, 수식은 다음과 같다.  

$$
z = \frac{X - \mu}{\sigma}
$$   

### **범주형 데이터**  

범주형(카테고리) 데이터는 성별과 같이 유한한 선택 범위의 값을 가지는 데이터이다.  

이러한 범주형 데이터는 일반적으로 문자열 형식으로 구성되어 있다.  

일반적인 학습에서는 이러한 범주형 데이터는 반드시 수치형 데이터로 전환해야 학습이 가능하다.  

##### **순서형 인코딩(ordinal encoding)**  

순서형 인코딩 방법은 데이터의 각 값들 사이에 대소 관계가 존재할 때 사용할 수 있는 방법이다.  

예를 들어, 선호도를 상,중,하로 평가한 데이터가 있을 때, 이 데이터는 상 > 중 > 하의 대소 관계를 가진다.  

이런 경우에 상:3, 중:2, 하:1 등으로 표현할 수 있을 것이다.  

중요한 점은 변환된 후에도 기존의 대소 관계를 유지할 수 있어야 한다.  

##### **원핫 인코딩(one-hot encoding)**  

원핫 인코딩은 값들 사이의 대소 관계가 존재하지 않을 때 주로 사용된다.  

예를 들어, 혈액형같은 데이터는 A,B,AB,O형이 존재하는데 이러한 데이터는 대소 관계가 존재하지 않는다.  

이런 경우에 원핫 인코딩을 사용하여 4차원의 희소 벡터를 생성한다.  

예를 들어, 각각의 혈액형에 대하여 다음과 같이 표현할 수 있다.  

  A B AB O  
  1 0 0  0 : A  
  0 1 0  0 : B  
  0 0 1  0 : AB  
  0 0 0  1 : O  

원핫 인코딩의 경우 값이 다양할 경우 공간 문제를 생각해야 한다.  

원핫 인코딩은 특정 값만 1이 되고 나머지는 0으로 표현된다.  

혈액형의 경우에는 4차원만 사용하면 해결이 가능하지만, 동물의 종류를 원핫 인코딩으로 나타내야 한다면 어떨까?  

이런 경우, 희소 벡터를 사용하여 공간을 절약해주는 것이 좋다.  

추가적으로, 모든 차원들이 분류, 예측 등의 학습과정에 도움을 주는 것은 아니다.  

피처 선택과 함께 차원의 수를 줄일 수 있다면 도움이 될 것이다.  


<br/>
